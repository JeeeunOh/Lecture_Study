**π’΅Β Transport Layer Security**

TLSμ™€ SSLμ€ μ»΄ν“¨ν„° μ‚¬μ΄μ λ„¤νΈμ›ν¬ ν†µμ‹ μ— λ³΄μ•μ„ μ κ³µν•λ” ν”„λ΅ν† μ½μ΄λ‹¤.

TLS : ν΄λΌ β†” μ„λ²„ μ»¤λ„¥νΈ μ‹ κ³µκ²©μκ°€ μ»¤λ„¥νΈλ¥Ό μ½μ„ μ μκΈ° λ•λ¬Έμ—,

μ„λ²„ λ³΄νΈλ¥Ό μ„ν• ν΄λΌμ΄μ–ΈνΈ μΈμ¦ μ •λ³΄ & ν΄λΌμ΄μ–ΈνΈ λ³΄νΈλ¥Ό μ„ν• μ„λ²„ μΈμ¦ μ •λ³΄λ¥Ό μ κ³µν•λ‹¤.

<br/>

**π’΅Β Background ( μ†μ„± )**

- `Confidentiality` : κΈ°λ°€μ„±
    - κ³µκ²©μκ°€ λ°μ΄ν„°λ¥Ό λ³Ό μ μ—†κ² λ³΄νΈν•¨.
    - λ°μ΄ν„°μ μ•”νΈν™” & λ³µνΈν™” μ κ³µ
- `Integrity` : λ¬΄κ²°μ„±
    - λ°μ΄ν„°μ μ›λ³Έμ΄ ν›Όμ†λμ§€ μ•λ„λ΅ ν•¨.
        
        like ν•΄μ‹ λ² μ΄μ¤μ HMAC μ²λΌ λ¬΄κ²°μ„± μ κ³µ
        
- `Availability` : κ°€μ©μ„±
    - μΈμ¦λ μ‚¬λμ—κ²λ” λ°μ΄ν„°κ°€ μ‚¬μ©κ°€λ¥ν•΄μ•Όν•λ‹¤λ” κ²ƒ
- `Authenticity`
    - μΈμ¦μ„± : μƒλ€λ°©μ μ‹ μ›μ •λ³΄λ¥Ό μΈμ¦ κ°€λ¥
        - Man in the Middle ( MITM ) κ³µκ²©κ°™μ€ κ±Έ λ§‰μ„ μ μμ.
- `Non-repudiation`
    - λ¶€μΈλ°©μ§€ : μ†΅μ‹ μκ°€ μμ‹ μμ—κ² λ³΄λ‚Έ μ •λ³΄λ¥Ό μμ‹ μ΄ λ³΄λ‚΄μ§€ μ•μ•λ‹¤κ³  λ¶€μ •ν•λ” κ²ƒ λ°©μ§€

<br/>

**π’΅Β Background ( TLS records )**

- SSL/TLSμ key μ†μ„±μ€ λ‹¤μκ³Ό κ°™μ΄ λ””μμΈ λ¨.
    - Handshake ν”„λ΅ν† μ½
        - μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ μ„ν•΄ λ§λ“¤μ–΄μ§„ μΈμ¦λ Authenticated Key Exchange ( AKE )
    - record ν”„λ΅ν† μ½
- μ¶”κ°€λ΅ Alert ν”„λ΅ν† μ½, ChangeCipherSpec ν”„λ΅ν† μ½

`Handshake ν”„λ΅ν† μ½`μ€ μ•”νΈν™” λ°©μ‹μ„ ν‘μƒν•κ³ , μ„λ΅ μΈμ¦μ„λ¥Ό κµν™ν•λ©° μ„Έμ…ν‚¤λ¥Ό μƒμ„±ν•λ” κ³Όμ •μ„ λ‹΄λ‹Ή

`Record ν”„λ΅ν† μ½`μ€ μ‹¤μ  λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•μ—¬ μ „μ†΅ν•λ” κ³Όμ •μ„ λ‹΄λ‹Ή.

μ΄ κ³Όμ •μ„ κ±°μ³ TLSλ” μ•μ „ν•κ³  μ‹ λΆ°μ„±μλ” ν†µμ‹ μ„ μ κ³µν•¨.

`Handshake`

- TLS ν”„λ΅ν† μ½ λ²„μ „ ν‘μƒ
- μ•”νΈ μ•κ³ λ¦¬μ¦ μ„ νƒ
- λΉ„λ€μΉ­ν‚¤λ΅ μ„λ΅λ¥Ό κ²€μ¦ν•¨.
- λ€μΉ­ μ•”νΈν™”λ¥Ό μ„ν•΄ λΉ„λ°€ν‚¤ μƒμ„±

`Record`

- λΉ„λ°€ν‚¤λ΅ λ©”μ‹μ§€ μ•”νΈν™”
- μ•”νΈν™”λ λ©”μ‹μ§€ μ „μ†΅
- λΉ„λ°€ν‚¤λ΅ λ©”μ‹μ§€ λ³µνΈν™”
- λ©”μ‹μ§€μ λ¬΄κ²°μ„± κ²€μ¦

μμ„Έν• λ™μ‘μ›λ¦¬ by chatGPT

- Handshake ν”„λ΅ν† μ½
    1. ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ— μ ‘μ†ν•μ—¬ TLS μ—°κ²° μ‹μ‘
    2. ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ—κ² μ§€μ›ν•λ” μ•”νΈν™”λ°©μ‹κ³Ό νΈν™κ°€λ¥ν• ν”„λ΅ν† μ½ λ²„μ „μ„ μ•λ¦¬λ” ClientHello λ©”μ‹μ§€λ¥Ό λ³΄λƒ„.
    3. μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈμ λ©”μ‹μ§€λ¥Ό λ°›μ•„λ“¤μ΄κ³ , μ„λ²„κ°€ μ§€μ›ν•λ” μ•”νΈν™” λ°©μ‹κ³Ό ν”„λ΅ν† μ½ λ²„μ „μ„ ν΄λΌμ΄μ–ΈνΈμ—κ² μ•λ¦¬λ” ServerHello λ©”μ‹μ§€λ¥Ό λ³΄λƒ„.
    4. ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” μ„λ΅ μΈμ¦μ„λ¥Ό κµν™ν•κ³  μ„λ΅μ μΈμ¦μ„κ°€ μ‹ λΆ°ν•  μ μλ” κ²ƒμΈμ§€ ν™•μΈ
    5. ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” μ„Έμ… ν‚¤λ¥Ό μƒμ„±ν•κ³ , μ΄λ¥Ό μ‚¬μ©ν•μ—¬ μ•”νΈν™”λ ν†µμ‹ μ„ μ‹μ‘ν•¨.
- Record ν”„λ΅ν† μ½
    1. Handshake ν”„λ΅ν† μ½μ—μ„ μƒμ„±ν• μ„Έμ…ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•¨.
    2. μ•”νΈν™”λ λ°μ΄ν„°λ¥Ό Record ν”„λ΅ν† μ½μ—μ„ μ „μ†΅ν•¨.
    3. λ°μ΄ν„°λ¥Ό μμ‹ ν•λ” μΈ΅μ—μ„λ” Record ν”„λ΅ν† μ½μ„ μ‚¬μ©ν•μ—¬ λ°μ΄ν„°λ¥Ό λ³µνΈν™” ν•¨.
- μΆ…λ£
    1. ν†µμ‹ μ΄ λλ‚  λ•λ” ν΄λΌμ΄μ–ΈνΈλ‚ μ„λ²„μ—μ„ close_notify λ©”μ‹μ§€λ¥Ό μ „μ†΅ν•¨.
    2. μƒλ€λ°©μ΄ close_notify λ©”μ‹μ§€λ¥Ό λ°›μΌλ©΄, TLS μ—°κ²°μ„ μΆ…λ£ν•¨.

- TLSκ°€ λ‹Ήν•  μ μλ” κ³µκ²© & ν•΄κ²°λ°©μ•
    1. **μ¤‘κ°„μ κ³µκ²© ( Man in the middle attack )**
        
        TLSλ” μΈμ¦ κΈ°λ¥μ„ ν†µν•΄ μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ κ°„μ ν†µμ‹  μ•μ •μ„±μ„ λ³΄μ¥ν•¨.
        
        μ΄ λ• μΈμ¦μ„κ°€ μ„μ΅°λ  μ μμΌλ©° μ¤‘κ°„μ κ³µκ²©μΌλ΅ κ³µκ²©μκ°€ μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ μ„μ΅° κ°€λ¥
        
        β†’ μΈμ¦μ„λ¥Ό λ°κΈ‰ν•λ” CAμ μ‹ λΆ°μ„±μ„ λ†’μ΄κ³  μΈμ¦μ„λ¥Ό κ²€μ¦ν•΄μ•Ό ν•¨.
        
    2. **λ¦¬ν”λ μ΄ κ³µκ²©** 
        
        κ³µκ²©μλ” κΈ°μ΅΄μ TLS μ„Έμ…μ—μ„ μ‚¬μ©λ ν¨ν‚·μ„ μ €μ¥ν•κ³ , μ΄λ¥Ό μ¬μ „μ†΅ν•μ—¬ κ³µκ²© κ°€λ¥.
        
        β†’ Nonceλ¥Ό ClientHello κ°’μ— ν¬ν•¨μ‹μΌ ν¨ν‚·μ μ¤‘λ³µ μ „μ†΅ λ§‰κΈ°
        
    3. **DDoS κ³µκ²©**
        
        λ‹¤μμ μ»΄ν“¨ν„°λ¥Ό μ΄μ©ν•μ—¬ λ€μƒ μ„λ²„μ— λ€λ‰μ μ”μ²­μ„ λ³΄λ‚΄ μ„λΉ„μ¤λ¥Ό λ§λΉ„μ‹ν‚¤λ” κ³µκ²©.
        
        TLSλ” λ€μƒ μ„λ²„μ λ¶€ν•λ¥Ό μ¤„μ΄κΈ° μ„ν•΄ SSL/TLS ν•Έλ“μ‰μ΄ν¬ κ³Όμ •μ„ λλ¦¬κ² μ§„ν–‰ν•λ” Slowloris, R-U-Dead-Yet λ“±μ κ³µκ²© λ°©μ–΄
        
    4. μ·¨μ•½ν• μ•”νΈν™” μ‚¬μ© (Weak encryption)
    TLSλ” RC4 λ“±μ μ·¨μ•½ν• μ•”νΈν™” λ°©μ‹μ„ μ‚¬μ©ν•λ©΄ κ³µκ²©μκ°€ μ•”νΈν™”λ λ°μ΄ν„°λ¥Ό λ³µνΈν™”ν•  μ μμµλ‹λ‹¤. TLSλ” λ³΄λ‹¤ κ°•λ ¥ν• μ•”νΈν™” λ°©μ‹μ„ μ‚¬μ©ν•μ—¬ μ΄λ¥Ό λ°©μ§€ν•©λ‹λ‹¤.
    5. μ„λΉ„μ¤ κ±°λ¶€ κ³µκ²© (Denial of Service attack)
    μ„λΉ„μ¤ κ±°λ¶€ κ³µκ²©μ€ λ€μƒ μ„λ²„μ μμ›μ„ κ³ κ°μ‹μΌ μ„λΉ„μ¤λ¥Ό μ¤‘λ‹¨μ‹ν‚¤λ” κ³µκ²©μ…λ‹λ‹¤. TLSλ” λ€μƒ μ„λ²„μ μμ›μ„ μ μ ν•λ” SSL/TLS ν•Έλ“μ‰μ΄ν¬ κ³Όμ •μ„ λλ¦¬κ² μ§„ν–‰ν•λ” Slowloris, R-U-Dead-Yet λ“±μ κ³µκ²©μ„ λ°©μ–΄ν•©λ‹λ‹¤.
    6. μ•”νΈν™” μ·¨μ•½μ  κ³µκ²© (Cryptographic vulnerability attack)
    μ•”νΈν™” μ·¨μ•½μ  κ³µκ²©μ€ μ•”νΈν™” κΈ°μ  μμ²΄μ— μ·¨μ•½μ μ΄ μλ” κ²½μ°λ¥Ό λ§ν•©λ‹λ‹¤. TLSλ” μ·¨μ•½μ μ΄ μλ” μ•”νΈν™” κΈ°μ μ„ μ‚¬μ©ν•μ§€ μ•κ³ , ν•­μƒ λ³΄μ•μ„±μ΄ κ²€μ¦λ

<br/>

**π’΅TLS : Handshake**

ClientHello :

 λ¬΄μ‘μ„ λ‚μ ν¬ν•¨

μ΄ λ‚μλ” ν•λ²λ§ μ‚¬μ©λλ” μ„μμ μ«μμ΄κΈ° λ•λ¬Έμ— **λ¦¬ν”λ μ΄ μ–΄νƒ λ§‰μ**

Certificate :

ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ—μ„ λ°›μ€ μΈμ¦μ„λ¥Ό κ²€μ¦ν•¨. 

ClientKeyExchange :

κ²€μ¦μ΄ μ™„λ£λλ©΄ ν΄λΌμ΄μ–ΈνΈκ°€ μƒμ„±ν• μ„μμ λΉ„λ°€ν‚¤λ¥Ό μ΄μ©ν•΄ μ„λ²„κ°€ λ³΄λ‚Έ μΈμ¦μ„μ— ν¬ν•¨λ κ³µκ°ν‚¤λ¥Ό μ‚¬μ©ν•΄ μ•”νΈν™”ν•¨. μ΄λ ‡κ² μ•”νΈν™”λ λΉ„λ°€ν‚¤λ¥Ό ClientKeyExchangeμ— ν¬ν•¨μ‹μΌ μ„λ²„μ— λ³΄λƒ„.

ChangeCipherSpec :

μ„λ²„λ” μ „μ†΅λ°›μ€ μ •λ³΄λ¥Ό λ³µνΈν™”ν•΄ λΉ„λ°€ν‚¤λ¥Ό μ•μ•„λ‚Έ λ‹¤μ μ΄ λΉ„λ°€ν‚¤λ¥Ό ν†µν•΄ μ„Έμ…ν‚¤λ¥Ό λ§λ“¤μ–΄λƒ„.

ν΄λΌμ΄μ–ΈνΈ λν• λΉ„λ°€ν‚¤ μ •λ³΄κ°€ μμΌλ―€λ΅ μ„Έμ…ν‚¤λ¥Ό λ§λ“¤μ–΄λ‚Ό μ μμ.

ChangeCiperSpecλ¥Ό λ³΄λ‚΄ μ•μΌλ΅ λ¨λ“  ν†µμ‹  λ‚΄μ©μ€ μ„Έμ…ν‚¤λ¥Ό μ‚¬μ©ν•΄ μ•”νΈν™”ν•΄ λ³΄λ‚Ό κ²ƒμ„ μ•λ ¤μ¤

Finished :

μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈλ” κ°μ λ™μΌν• μ„Έμ…ν‚¤λ¥Ό κ°€μ§€κ³  μμΌλ©° 

μ΄ ν‚¤λ¥Ό μ‚¬μ©ν•΄ λ€μΉ­ν‚¤ μ•”νΈλ¥Ό μ΄μ©ν•λ” ν†µμ‹ μ„ ν•  μ μμ. 

Finished λ©”μ‹μ§€λ¥Ό λ³΄λ‚΄ κ°μμ ν•Έλ“μ…°μ΄ν‚Ή κ³Όμ •μ΄ λλ‚¬μμ„ μ•λ¦Ό.

μ΄ λ• μ„Έμ… μμ²΄μ—μ„ λ€μΉ­ν‚¤ μ•”νΈλ¥Ό μ“°λ” μ΄μ ! : λΉ„λ€μΉ­ν‚¤μ•”νΈλ” μ†λ„κ°€ λλ¦¬κΈ° λ•λ¬Έ

λ‘ κ°€μ§€ λ°©λ²•μΌλ΅ ν΄λΌ β†” μ„λ²„ κ²€μ¦ κ°€λ¥

1. **λ¬Έμμ—΄ μ•”νΈν™” λ“± ( κ³µκ°ν‚¤ μ•”νΈν™” λ°©μ‹ like RSA λ“± )**
    
    Aκ°€ κ³µκ°ν‚¤λ΅ λ¬΄μ‘μ„ μ•”νΈν™”ν•΄μ„ Bμ—κ² λ³΄λƒ„.
    
    β†’ Bκ°€ κ°μΈν‚¤λ΅ ν•΄λ…ν•΄μ„ Aμ—κ² λ³΄λƒ„ β†’ κ²€μ¦μ™„!
    
    1. μ„λ²„λ” κ³µκ°ν‚¤ μΈμ¦μ„λ¥Ό ν΄λΌμ΄μ–ΈνΈμ—κ² λ³΄λƒ„.
    2. ν΄λΌμ΄μ–ΈνΈλ” μΈμ¦μ„κ°€ μ‹ λΆ°ν•  μ μλ” μΈμ¦κΈ°κ΄€μΌλ΅λ¶€ν„° λ°κΈ‰λμ—λ”μ§€ ν™•μΈν•¨.
    3. ν΄λΌμ΄μ–ΈνΈλ” μΈμ¦μ„ μ•μ— μλ” μ„λ²„μ κ³µκ°ν‚¤λ¥Ό μ¶”μ¶ν•¨.
    4. ν΄λΌμ΄μ–ΈνΈλ” μ΄ κ³µκ°ν‚¤λ¥Ό μ΄μ©ν•μ—¬ λλ¤ν• λΉ„λ°€ν‚¤λ¥Ό μ•”νΈν™”ν•΄μ„ μ„λ²„μ—κ² λ³΄λƒ„.
    5. μ„λ²„λ” μ΄ λλ¤ν• λΉ„λ°€ν‚¤λ¥Ό μμ‹ μ κ°μΈν‚¤λ΅ λ³µνΈν™”ν•΄μ„ λΉ„λ°€ν‚¤λ¥Ό μƒμ„±ν•¨.
    6. ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” λΉ„λ°€ν‚¤λ¥Ό μ΄μ©ν•μ—¬ μ„Έμ…ν‚¤λ¥Ό μƒμ„±ν•¨.
    
    μ·¨μ•½μ  )
    
    - μ„λ²„μ κ°μΈν‚¤κ°€ μ μ¶λ  κ²½μ° μ¤‘κ°„μ κ³µκ²©μ΄ κ°€λ¥ν•¨.
    - μ„λ²„μ κ³µκ°ν‚¤κ°€ μΈμ¦κΈ°κ΄€μ— μν•΄ μΈμ¦λμ—μ§€λ§ μΈμ¦κΈ°κ΄€μ΄ μ‹ λΆ°ν•  μ μ—†λ” κ²½μ°μ—λ„ λ³΄μ• μ•½ν™” κ°€λ¥
        
        β†’ μΈμ¦μ„ ν¨μΉ­κ³Ό κ°™μ€ λ³΄μ• λ¬Έμ κ°€ λ°μƒν•  μ μμ.
        
    - RSA μ•κ³ λ¦¬μ¦μ μ²λ¦¬μ†λ„κ°€ λλ¦¬λ‹¤λ” λ‹¨μ λ„ μμ.
    
2. **μ „μμ„λ…**
    
    A β†’ Bμ—κ² M λ³΄λƒ„.
    
    Bλ” Aμ κ³µκ°ν‚¤ μ΄μ©ν•΄μ„ μ•”νΈν™”ν•κ³  Bμ κ°μΈν‚¤ μ΄μ©ν•΄μ„ μ„λ…
    
    Aλ” Aμ κ°μΈν‚¤ μ΄μ©ν•΄μ„ λ³µνΈν™”ν•κ³  Bμ κ³µκ°ν‚¤ μ΄μ©ν•΄μ„ μ„λ… κ²€μ¦
    
    1. μ„λ²„λ” μμ‹ μ **κ°μΈν‚¤λ¥Ό μ΄μ©ν•μ—¬ μ „μμ„λ…μ„ μƒμ„±**ν•¨.
    2. ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„λ΅λ¶€ν„° λ°›μ€ **μΈμ¦μ„μ—μ„ κ³µκ°ν‚¤ μ¶”μ¶**
    3. ν΄λΌμ΄μ–ΈνΈλ” μΈμ¦μ„μ— λ€ν• μ„λ²„μ μ „μμ„λ…μ„ κ²€μ¦ν•κΈ° μ„ν•΄
        
        μ„λ²„μ **κ³µκ°ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ λ””μ§€ν„Έ μ„λ…μ„ κ²€μ¦**ν•κ³  **μΈμ¦μ„μ—μ„ μ„λ²„μ μ‹ μ› μ •λ³΄ μ¶”μ¶**
        
    4. ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ **μ‹ μ› μ •λ³΄ κ²€μ¦**ν•¨.
    
    μ·¨μ•½μ  )
    
    - μΈμ¦μ„λ¥Ό κ°€μ Έκ°€λ” μ¤‘κ°„μ κ³µκ²©μ—λ” λ°©μ–΄κ°€ κ°€λ¥ν•μ§€λ§, **μ „μμ„λ…μ„ μ„μ΅°ν•λ” μ¤‘κ°„μ κ³µκ²©μ—λ” μ·¨μ•½**
        
        β†’ μ„λ²„ μΈμ¦μ„κ°€ μ‹ λΆ°ν•  μ μλ” κ²ƒμΈμ§€ ν™•μΈν•΄μ•Ό ν•¨.
        
    - μ „μμ„λ…μ„ μ„ν• **κ°μΈν‚¤λ¥Ό λ¶„μ‹¤ν•κ±°λ‚ λ„λ‚λ‹Ήν•λ©΄ μ•λ¨.**
    
3. **CA μΈμ¦μ„ ( μ±—μ§€ν”Όν‹° )**
    1. ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ—κ² μ—°κ²° μ”μ²­μ„ λ³΄λ‚΄κ³ , 
        
        μ„λ²„λ” μ΄μ— λ€ν• μ‘λ‹µμΌλ΅ μ„λ²„ μΈμ¦μ„μ™€ μμ‹ μ κ³µκ°ν‚¤λ¥Ό μ „μ†΅
        
    2. ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„ μΈμ¦μ„μ μ ν¨μ„±μ„ κ²€μ‚¬ν•¨. μΈμ¦μ„κ°€ CAμ— μν•΄ λ°κΈ‰λμ—λ”μ§€, 
        
        μ ν¨κΈ°κ°„μ΄ μ§€λ‚μ§€ μ•μ•λ”μ§€ λ“±μ„ κ²€μ‚¬ν•¨.
        
    3. ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ κ³µκ°ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ λΉ„λ°€ν‚¤λ¥Ό μƒμ„±ν•¨.
        
        μ΄ λΉ„λ°€ν‚¤λ” μ΄ν›„ μ„Έμ…ν‚¤ μƒμ„±μ— μ‚¬μ©λ¨.
        
    4. ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ μ„Έμ…ν‚¤λ¥Ό κµν™ν•¨.
    5. ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” μ„λ΅λ¥Ό μ‹ λΆ°ν•κ³  μ΄ν›„ Record ν”„λ΅ν† μ½λ΅ λ°μ΄ν„° ν†µμ‹ μ„ μ§„ν–‰ν•¨.
